<class version="1.0"
	name="App.Pattern" extends="Runtime.Web.Component" 
	module="Runtime.Web.Backend" model="Runtime.Web.App.LayoutModel"
>

<use name="Runtime.Web.App.WebApp" />

<template name="render" args="RenderContainer container, LayoutModel layout, Dict params, var content">
<html>
<head>
<title>{ WebApp::callTitleChain(layout, layout.title) }</title>
<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon" />
<link rel='stylesheet' href={ layout.route_prefix ~ "/assets/app.css?_=" ~ layout.f_inc } />
<style id='root_style'>@raw{ rs::spaceless( WebApp::getLayoutCSS(layout) ) }</style>
</head>
<body>

%var string model_encoded = rs::base64_encode_url(rtl::json_encode(layout));
%var string frontend_storage = rs::base64_encode_url(rtl::json_encode(layout.frontend_storage));

<div id='root'>{ content }</div>
<input id='root_model' type='hidden' value={ model_encoded } />
<input id='frontend_storage' type='hidden' value={ frontend_storage } />

<script src={ layout.route_prefix ~ "/assets/render.js?_=" ~ layout.f_inc }></script>
<script src={ layout.route_prefix ~ "/assets/components.js?_=" ~ layout.f_inc }></script>
<script src={ layout.route_prefix ~ "/assets/app.js?_=" ~ layout.f_inc }></script>

<script>runWebApp(@json{ container.frontend_env }, "App", "App.Frontend");</script>

</body>
</html>
</template>

</class>